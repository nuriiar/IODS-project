---
title: "chapter3.Rmd"
output: html_document
date: "2022-11-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Assignment 3 

```{r}
#Opening relevant libraries

library(tidyverse)
library(readr)
library(dplyr)
library(ggplot2)
```
```{r}
#reading the csv data set, looking at column names and structure. It has 35 variables and 370 rows. This dataset present merged results of questionnaire of two Portuguese schools on student achievement in math and Portuguese language class and alcohol consumption in secondary education. The data attributes include student grades, demographic, social and school related features and it was collected by using school reports and questionnaires. More on the dataset from: https://archive.ics.uci.edu/ml/datasets/Student+Performance

alc <- read_csv("alcohol.csv",col_names = TRUE)
colnames(alc)
str(alc)
```
##Background and objectives

#The analysis aims at identifying the social and health status related reasons behind the high alcohol consumption among students. This report will estimate #a logistic regression model for alcohol consumption as dependent variable and health status, parents education, as well as the desire to take higher #education. Therefore the hypotheses are:
#1. Low health status is associated with higher alcohol consumption
#2. Parents lower education is associated with higher alcohol consumption
#3. Willingness to get higher education is associated with higher alcohol consumption

##Expoling the variables
```{r}

library(tidyverse)
library(readr)
library(dplyr)
library(ggplot2)
library(gmodels)
##Crosstabulating the variables
health_tab <- CrossTable(alc$high_use, alc$health, digits = 1, prop.c = T, chisq = T)
Medu_tab <- CrossTable(alc$high_use, alc$Medu, digits = 1, prop.c = T, chisq = T)
Fedu_tab <- CrossTable(alc$high_use, alc$Fedu, digits = 1, prop.c = T, chisq = T)
higher_tab <- CrossTable(alc$high_use, alc$higher, digits = 1, prop.c = T, chisq = T)

```
##bar charts
```{r}
health_bp <- ggplot(data = alc, aes(x=health, fill = high_use))
health_bp + geom_bar(position=position_dodge()) + labs(y="self-rated health")
```


